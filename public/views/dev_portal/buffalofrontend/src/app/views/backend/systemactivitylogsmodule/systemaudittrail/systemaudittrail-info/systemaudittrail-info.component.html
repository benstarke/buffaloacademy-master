<div class="wrapper">

    <div class="row page-titles mx-0">
        <div class="col-sm-6 p-md-0">
            <div class="welcome-text">
                <h4>Audit Trail List</h4>
            </div>
        </div>
        <div class="col-sm-6 p-md-0 justify-content-sm-end mt-2 mt-sm-0 d-flex">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a routerLink="/admin-buffalo/master-dashboard">Home</a></li>
                <li class="breadcrumb-item active"><a routerLink="/admin-buffalo/system-activity-and-logs/dashboard-system-audit-trail">Audit Trail</a></li>
                <li class="breadcrumb-item active"><a routerLink="/admin-buffalo/system-activity-and-logs/dashboard-system-audit-trail">All Audits</a></li>
            </ol>
        </div>
    </div> 

   <!-- Spinner -->
	<div *ngIf="isLoading" class="spinner-container">
		<div class="spinner"></div>
	</div>

    <div *ngIf="!isLoading">
        <!-- Data Grid to display Tags -->
        <dx-data-grid class="table row-border hover" 
        id="multipleSystemAuditTrailGrid"
        [dataSource]="systemAuditTrail" 
        [remoteOperations]="true" 
        [showBorders]="true"
        [allowColumnResizing]="true" 
        [columnHidingEnabled]="false" 
        [selection]="{ mode: 'multiple' }"
        (onExporting)="onExporting($event)"
        (onSelectionChanged)="selectionChanged($event)" 
        (onSelectionChanged)="onSelectionChanged($event)" 
        (onContentReady)="onContentReady($event)"
        keyExpr="id">

        <!-- master detail api -->
        <dxo-master-detail [enabled]="true" template="detail"></dxo-master-detail>
        <!-- master detail api -->

        <dxo-search-panel [visible]="true"></dxo-search-panel>
        <dxo-paging [enabled]="true"></dxo-paging>
        <dxo-pager [showInfo]="true" 
        infoText="Page #{0}. Total: {1} ({2} items)" 
        [showPageSizeSelector]="true"
        [allowedPageSizes]="[10,20]"></dxo-pager>

        <dxo-export 
        [enabled]="true" 
        [formats]="['xlsx', 'csv']"
        fileName="SystemAuditTrail" 
        [allowExportSelectedData]="true">
        </dxo-export>

        <dxo-selection mode="multiple"></dxo-selection>
        <dxo-group-panel [visible]="true"></dxo-group-panel>
        <dxi-column dataField="id" caption="ID" [visible]="false"></dxi-column>
        <dxi-column dataField="table_name" caption="Table Name"></dxi-column>
        <dxi-column dataField="table_action" caption="Table Action"></dxi-column>

        <dxi-column dataField="ip_address" caption="IP Address"></dxi-column>
        <dxi-column dataField="created_by" caption="Created By"></dxi-column>
        <dxi-column dataField="created_at" caption="Created On"></dxi-column>
        <dxi-column dataField="updated_by" caption="Updated By"></dxi-column>
        <dxi-column dataField="updated_at" caption="Updated On"></dxi-column>
        <dxi-column dataField="altered_by" caption="Deleted By"></dxi-column>
        <dxi-column dataField="altered_at" caption="Deleted On"></dxi-column>

        <!-- Master-detail template for prev_tabledata and current_tabledata -->
        <div *dxTemplate="let detailInfo of 'detail'">
            <div class="detail-info">
                <h4>Previous Table Data:</h4>
                <div class="scrollable-content">
                    <p class="employeeContent" [innerHTML]="detailInfo.data.prev_tabledata"></p>
                </div>
                <h4>Current Table Data:</h4>
                <div class="scrollable-content">
                    <p class="employeeContent" [innerHTML]="detailInfo.data.current_tabledata"></p>
                </div>
            </div>
        </div>
        <dxo-paging [pageSize]="20"></dxo-paging>
        </dx-data-grid>

        
    </div>
  
</div>
  