<div class="wrapper">

  <!-- Add Button -->
  <dx-button text="Add New Tag" type="default" icon="fa fa-plus"
    [elementAttr]="{ id: 'elementId', class: 'pull-right' }" (onClick)="onAddTagClick()">
  </dx-button>

  <!-- Add Tag Popup -->
  <ng-container *ngIf="addTagForm.value && addPopupVisible">
    <dx-popup [(visible)]="addPopupVisible" [width]="550" [height]="300" [showTitle]="true"
        [title]="'Add New Tag'" (onHidden)="onPopupHidden()">
        <form (ngSubmit)="onAddTagSubmit()" [formGroup]="addTagForm">

            <div class="row">
                <div class="col-lg-12">
                    <label for="name">Tag Name:</label>
                    <dx-text-box formControlName="name" placeholder="Tag Name"></dx-text-box>
                </div>

                <div class="col-lg-12">
                    <label for="description">Description:</label>
                    <dx-text-area formControlName="description" placeholder="Description"></dx-text-area>
                </div>
            </div>

            <div class="button-container">
                <dx-button text="Create" type="success" icon="fa fa-plus" [elementAttr]="{ class: 'pull-left' }"
                    (onClick)="onAddTagSubmit()"></dx-button>
                <dx-button text="Cancel" type="danger" icon="fa fa-times" [elementAttr]="{ class: 'pull-left' }"
                    (onClick)="addPopupVisible = false"></dx-button>
            </div>
        </form>
    </dx-popup>
  </ng-container>

  <!-- Update Tag Popup -->
  <ng-container *ngIf="updateTagForm.value && updatePopupVisible">
    <dx-popup [(visible)]="updatePopupVisible" [width]="550" [height]="300" [showTitle]="true"
        [title]="'Update Tag'" (onHidden)="onPopupHidden()">
        <form (ngSubmit)="onUpdateTagSubmit()" [formGroup]="updateTagForm">
            <!-- Tag Name -->
            <div class="col-lg-12">
              <label for="name">Tag Name:</label>
              <dx-text-box formControlName="name" placeholder="Tag Name"></dx-text-box>
            </div>
            <!-- Description -->
            <div class="col-lg-12">
              <label for="description">Description:</label>
              <dx-text-area formControlName="description" placeholder="Description"></dx-text-area>
            </div>
            <!-- Update and Cancel Buttons -->
            <div class="button-container">
              <dx-button text="Update" type="success" icon="fa fa-plus" [elementAttr]="{ class: 'pull-left' }"
                (onClick)="onUpdateTagSubmit()"></dx-button>
              <dx-button text="Cancel" type="danger" icon="fa fa-times" [elementAttr]="{ class: 'pull-left' }"
                (onClick)="updatePopupVisible = false"></dx-button>
            </div>
          </form>
          
    </dx-popup>
  </ng-container>

  <!-- Delete Tag Popup -->
  <ng-container *ngIf="deleteTagForm.value && deletePopupVisible">
    <dx-popup [(visible)]="deletePopupVisible" height="200" width="600" [showTitle]="true" title="Delete Confirmation"
        (onHidden)="deletePopupVisible = false">
        <form (ngSubmit)="onDeleteTagSubmit()" [formGroup]="deleteTagForm">
            <div>
                <p *ngIf="deleteTagForm.value && deletePopupVisible" class="confirmation-text">
                    Are you sure you want to delete "<strong>{{deleteTagForm.value.name}}</strong>"?
                </p>
                <div class="button-container">
                    <dx-button text="Yes" type="danger" (onClick)="onDeleteTagSubmit()"></dx-button>
                    <dx-button text="No" (onClick)="deletePopupVisible = false"></dx-button>
                </div>
            </div>
        </form>
    </dx-popup>
  </ng-container>

  <!-- Data Grid to display Tags -->
  <dx-data-grid class="table row-border hover" [dataSource]="tags" [remoteOperations]='true' [showBorders]="true"
    [allowColumnResizing]="true" [columnHidingEnabled]="false" (onSelectionChanged)="selectionChanged($event)" keyExpr="id">
    <!-- <dxo-filter-row [visible]="true"></dxo-filter-row> -->
    <dxo-search-panel [visible]="true"></dxo-search-panel>
    <dxo-paging [enabled]="true"></dxo-paging>
    <dxo-pager [showInfo]="true" infoText="Page #{0}. Total: {1} ({2} items)" [showPageSizeSelector]="true"
        [allowedPageSizes]="[5,10]"></dxo-pager>
    <!-- <dxo-export [enabled]="true" fileName="Tags" [allowExportSelectedData]="true"></dxo-export> -->
    <!-- <dxo-selection mode="multiple"></dxo-selection> -->
     <!-- Selection, group panel, and other configurations -->
    <dxo-selection mode="single"></dxo-selection>
    <dxo-group-panel [visible]="true"></dxo-group-panel>

    <dxo-group-panel [visible]="true"></dxo-group-panel>
    <dxi-column dataField="id" caption="ID" [visible]="false"></dxi-column>
    <dxi-column dataField="name" caption="Tag Name"></dxi-column>
    <dxi-column dataField="description" caption="Description"></dxi-column>
    <dxi-column dataField="author" caption="Created By"></dxi-column>
    <dxi-column dataField="duration" caption="Time Posted"></dxi-column>

    <!-- Code for displaying Edit and Delete actions -->
    <dxi-column [width]="150" caption="Action" name="command-editing"
    [allowFiltering]="false" [allowSorting]="false" cellTemplate="cellTemplate">
    <div *dxTemplate="let data of 'cellTemplate'">
        <dx-menu (onItemClick)="permitTagActionColClick($event,data)"
            [items]="permitTagMenuItems"></dx-menu>
    </div>
    </dxi-column>
    
    <dxo-paging [pageSize]="10"></dxo-paging>
  </dx-data-grid>

</div>
